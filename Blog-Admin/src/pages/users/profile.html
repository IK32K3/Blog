<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Profile - Blog Admin</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <!-- Use CDN links for reliable loading on GitHub Pages -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Custom CSS with relative path -->
  <link href="../../assets/css/style.css" rel="stylesheet">
</head>
<body>
  <!-- Header -->
  <div data-inject="../../components/header.html"></div>

  <!-- Sidebar -->
  <div data-inject="../../components/sidebar.html"></div>
  <div class="sidebar-overlay"></div>

  <!-- Main Content -->
  <main id="main" class="main">
    <div class="pagetitle">
      <h1>User Profile</h1>
      <div class="profile-mode-indicator view-mode" id="viewModeIndicator">
        <i class="bi bi-eye"></i> View Mode
      </div>
      <div class="profile-mode-indicator edit-mode" id="editModeIndicator" style="display: none;">
        <i class="bi bi-pencil"></i> Edit Mode
      </div>
    </div>

    <section class="section profile">
      <div class="row">
        <div class="col-xl-4">
          <!-- Profile Card -->
          <div class="card">
            <div class="card-body profile-card pt-4 d-flex flex-column align-items-center">
              <img src="" alt="Profile" class="rounded-circle" id="profileImage">
              <h2 id="profileName">User Name</h2>
              <h3 id="profileRole">Role</h3>
              <div class="social-links mt-2">
                <a href="#" class="twitter"><i class="bi bi-twitter"></i></a>
                <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
                <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
                <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></a>
              </div>
            </div>
          </div>

          <!-- Profile Actions Card -->
          <div class="card" id="profileActions">
            <div class="card-body">
              <h5 class="card-title">Profile Actions</h5>
              <div class="d-grid gap-2" id="adminActions">
                <button class="btn btn-primary" id="editProfileBtn">
                  <i class="bi bi-pencil me-1"></i> Edit Profile
                </button>
                <button class="btn btn-danger" id="deleteUserBtn" style="display: none;">
                  <i class="bi bi-trash me-1"></i> Delete Account
                </button>
              </div>
            </div>
          </div>

          <!-- Profile Statistics Card -->
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">User Statistics</h5>
              <div class="d-flex flex-column">
                <div class="stat-card p-3 mb-2 bg-light rounded">
                  <div class="stat-card-title">Total Posts</div>
                  <div class="stat-card-value" id="totalPosts">0</div>
                </div>
                <div class="stat-card p-3 mb-2 bg-light rounded">
                  <div class="stat-card-title">Account Status</div>
                  <div class="stat-card-value" id="accountStatus">-</div>
                </div>
                <div class="stat-card p-3 bg-light rounded">
                  <div class="stat-card-title">Joined Date</div>
                  <div class="stat-card-value" id="joinedDate">-</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-xl-8">
          <div class="card">
            <div class="card-body pt-3">
              <!-- Tabs Navigation -->
              <ul class="nav nav-tabs nav-tabs-bordered" role="tablist">
                <li class="nav-item" role="presentation">
                  <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#profile-overview" type="button" role="tab" aria-controls="profile-overview" aria-selected="true">Overview</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="edit-tab" data-bs-toggle="tab" data-bs-target="#profile-edit" type="button" role="tab" aria-controls="profile-edit" aria-selected="false">Edit Profile</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="posts-tab" data-bs-toggle="tab" data-bs-target="#profile-posts" type="button" role="tab" aria-controls="profile-posts" aria-selected="false">Posts</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="change-password-tab" data-bs-toggle="tab" data-bs-target="#profile-change-password" type="button" role="tab" aria-controls="profile-change-password" aria-selected="false">Change Password</button>
                </li>
              </ul>

              <!-- Tabs Content -->
              <div class="tab-content pt-2">
                <!-- Overview Tab -->
                <div class="tab-pane fade show active profile-overview" id="profile-overview" role="tabpanel">
                  <h5 class="card-title">About</h5>
                  <p class="small fst-italic" id="userDescription">
                    User description will be displayed here.
                  </p>

                  <h5 class="card-title">Profile Details</h5>

                  <div class="row mb-2">
                    <div class="col-lg-3 col-md-4 label">Full Name</div>
                    <div class="col-lg-9 col-md-8" id="fullName">-</div>
                  </div>

                  <div class="row mb-2">
                    <div class="col-lg-3 col-md-4 label">Username</div>
                    <div class="col-lg-9 col-md-8" id="username">-</div>
                  </div>

                  <div class="row mb-2">
                    <div class="col-lg-3 col-md-4 label">Email</div>
                    <div class="col-lg-9 col-md-8" id="email">-</div>
                  </div>

                  <div class="row mb-2">
                    <div class="col-lg-3 col-md-4 label">Role</div>
                    <div class="col-lg-9 col-md-8" id="role">-</div>
                  </div>

                  <div class="row mb-2">
                    <div class="col-lg-3 col-md-4 label">Status</div>
                    <div class="col-lg-9 col-md-8" id="status">-</div>
                  </div>

                  <div class="row mb-2">
                    <div class="col-lg-3 col-md-4 label">Joined</div>
                    <div class="col-lg-9 col-md-8" id="joined">-</div>
                  </div>

                  <div class="row mb-2">
                    <div class="col-lg-3 col-md-4 label">Last Updated</div>
                    <div class="col-lg-9 col-md-8" id="lastUpdated">-</div>
                  </div>
                </div>

                <!-- Edit Profile Tab -->
                <div class="tab-pane fade profile-edit pt-3" id="profile-edit" role="tabpanel">
                  <!-- Profile Edit Form -->
                  <form id="profileEditForm">
                    <div class="row mb-3">
                      <label for="profileImageEdit" class="col-md-4 col-lg-3 col-form-label">Profile Image</label>
                      <div class="col-md-8 col-lg-9">
                        <div class="d-flex align-items-center mb-2">
                          <img id="profileImageEditPreview" src="" alt="Profile" style="max-height: 100px;" class="rounded-circle me-2">
                          <div>
                            <input type="file" class="form-control mb-2" id="profileImageInput" accept="image/*" onchange="previewImage(this, 'profileImageEditPreview')">
                            <button type="button" class="btn btn-outline-danger btn-sm">
                              <i class="bi bi-trash"></i> Remove
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="row mb-3">
                      <label for="fullNameEdit" class="col-md-4 col-lg-3 col-form-label">Full Name</label>
                      <div class="col-md-8 col-lg-9">
                        <input name="fullName" type="text" class="form-control" id="fullNameEdit" value="">
                      </div>
                    </div>

                    <div class="row mb-3">
                      <label for="usernameEdit" class="col-md-4 col-lg-3 col-form-label">Username</label>
                      <div class="col-md-8 col-lg-9">
                        <input name="username" type="text" class="form-control" id="usernameEdit" value="">
                      </div>
                    </div>

                    <div class="row mb-3">
                      <label for="emailEdit" class="col-md-4 col-lg-3 col-form-label">Email</label>
                      <div class="col-md-8 col-lg-9">
                        <input name="email" type="email" class="form-control" id="emailEdit" value="">
                      </div>
                    </div>

                    <div class="row mb-3">
                      <label for="roleEdit" class="col-md-4 col-lg-3 col-form-label">Role</label>
                      <div class="col-md-8 col-lg-9">
                        <select name="role" class="form-select" id="roleEdit">
                          <option value="1">Administrator</option>
                          <option value="2">Editor</option>
                          <option value="3">Author</option>
                          <option value="4">Contributor</option>
                          <option value="5">Subscriber</option>
                        </select>
                      </div>
                    </div>

                    <div class="row mb-3">
                      <label for="statusEdit" class="col-md-4 col-lg-3 col-form-label">Status</label>
                      <div class="col-md-8 col-lg-9">
                        <div class="form-check form-switch">
                          <input class="form-check-input" type="checkbox" id="statusEdit">
                          <label class="form-check-label" for="statusEdit">Account Active</label>
                        </div>
                      </div>
                    </div>

                    <div class="row mb-3">
                      <label for="descriptionEdit" class="col-md-4 col-lg-3 col-form-label">About</label>
                      <div class="col-md-8 col-lg-9">
                        <textarea name="description" class="form-control" id="descriptionEdit" rows="5"></textarea>
                      </div>
                    </div>

                    <div class="row mb-3">
                      <label for="socialLinks" class="col-md-4 col-lg-3 col-form-label">Social Links</label>
                      <div class="col-md-8 col-lg-9">
                        <div class="input-group mb-2">
                          <span class="input-group-text"><i class="bi bi-twitter"></i></span>
                          <input type="text" class="form-control" id="twitterEdit" placeholder="Twitter URL" value="">
                        </div>
                        <div class="input-group mb-2">
                          <span class="input-group-text"><i class="bi bi-facebook"></i></span>
                          <input type="text" class="form-control" id="facebookEdit" placeholder="Facebook URL" value="">
                        </div>
                        <div class="input-group mb-2">
                          <span class="input-group-text"><i class="bi bi-instagram"></i></span>
                          <input type="text" class="form-control" id="instagramEdit" placeholder="Instagram URL" value="">
                        </div>
                        <div class="input-group">
                          <span class="input-group-text"><i class="bi bi-linkedin"></i></span>
                          <input type="text" class="form-control" id="linkedinEdit" placeholder="LinkedIn URL" value="">
                        </div>
                      </div>
                    </div>

                    <div class="text-center">
                      <button type="submit" class="btn btn-primary">Save Changes</button>
                      <button type="button" class="btn btn-secondary" id="cancelEditBtn">Cancel</button>
                    </div>
                  </form>
                </div>

                <!-- Posts Tab -->
                <div class="tab-pane fade profile-posts pt-3" id="profile-posts" role="tabpanel">
                  <div class="card">
                    <div class="card-body">
                      <h5 class="card-title">User's Posts</h5>
                      <div class="table-responsive">
                        <table class="table table-striped">
                          <thead>
                            <tr>
                              <th scope="col">#</th>
                              <th scope="col">Title</th>
                              <th scope="col">Category</th>
                              <th scope="col">Language</th>
                              <th scope="col">Date</th>
                              <th scope="col">Status</th>
                              <th scope="col">Actions</th>
                            </tr>
                          </thead>
                          <tbody id="userPostsList">
                            <!-- Posts will be loaded here via JavaScript -->
                          </tbody>
                        </table>
                      </div>
                      <div id="emptyPostsMessage" class="empty-state" style="display:none;">
                        <i class="bi bi-journal-x"></i>
                        <p>No posts found for this user.</p>
                        <small>When the user creates posts, they will appear here.</small>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Change Password Tab -->
                <div class="tab-pane fade pt-3" id="profile-change-password" role="tabpanel">
                  <!-- Change Password Form -->
                  <form id="changePasswordForm">
                    <div class="row mb-3">
                      <label for="currentPassword" class="col-md-4 col-lg-3 col-form-label">Current Password</label>
                      <div class="col-md-8 col-lg-9">
                        <input name="currentPassword" type="password" class="form-control" id="currentPassword">
                      </div>
                    </div>

                    <div class="row mb-3">
                      <label for="newPassword" class="col-md-4 col-lg-3 col-form-label">New Password</label>
                      <div class="col-md-8 col-lg-9">
                        <input name="newPassword" type="password" class="form-control" id="newPassword">
                      </div>
                    </div>

                    <div class="row mb-3">
                      <label for="confirmPassword" class="col-md-4 col-lg-3 col-form-label">Confirm Password</label>
                      <div class="col-md-8 col-lg-9">
                        <input name="confirmPassword" type="password" class="form-control" id="confirmPassword">
                      </div>
                    </div>

                    <div class="text-center">
                      <button type="submit" class="btn btn-primary">Change Password</button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <div data-inject="../../components/footer.html"></div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Component loader
    document.addEventListener('DOMContentLoaded', () => {
      // Load components
      const components = document.querySelectorAll('[data-inject]');
      
      components.forEach(component => {
        let path = component.getAttribute('data-inject');
        
        fetch(path)
          .then(response => response.text())
          .then(html => {
            component.innerHTML = html;
          })
          .catch(error => {
            console.error('Error loading component:', path, error);
            component.innerHTML = `<div class="alert alert-danger">Failed to load component: ${path}</div>`;
          });
      });
      
      // Initialize profile page
      initProfilePage();
    });

    // Global variables
    let isCurrentUser = true;
    let userData = null;

    // Initialize profile page based on URL parameters
    function initProfilePage() {
      // Get user ID from URL parameters
      const urlParams = new URLSearchParams(window.location.search);
      const userId = urlParams.get('id');
      
      // If userId is provided in URL, we're viewing someone else's profile
      if (userId) {
        isCurrentUser = false;
        loadUserProfile(userId);
      } else {
        // No ID specified, load current user (admin) profile
        isCurrentUser = true;
        loadCurrentUserProfile();
      }
      
      // Set up event listeners
      setupEventListeners();
    }

    // Load the current user's profile (admin)
    function loadCurrentUserProfile() {
      // In a real application, this would be an API call
      // For demo purposes, we're using mock data
      userData = {
        id: 1,
        username: 'admin',
        fullName: 'Admin User',
        email: 'admin@example.com',
        role_id: 1,
        role: 'Administrator',
        description: 'System administrator responsible for managing the blog platform, users, and content. Has access to all features and functionality.',
        created_at: '2023-01-01T00:00:00',
        updated_at: '2023-04-15T10:30:00',
        is_active: true,
        posts_count: 42,
        profile_image: 'https://ui-avatars.com/api/?name=A+D&background=4154f1&color=fff'
      };
      
      updateUIWithUserData(userData);
      configureUIForCurrentUser();
    }

    // Load a specific user's profile
    function loadUserProfile(userId) {
      // In a real application, this would be an API call
      // For demo purposes, we're using mock data
      // Simulating different users based on ID
      const mockUsers = {
        '2': {
          id: 2,
          username: 'janesmith',
          fullName: 'Jane Smith',
          email: 'jane.smith@example.com',
          role_id: 2,
          role: 'Editor',
          description: 'Content editor with expertise in technology and lifestyle topics. Manages content quality and editorial standards.',
          created_at: '2023-02-20T00:00:00',
          updated_at: '2023-05-10T14:45:00',
          is_active: true,
          posts_count: 34,
          profile_image: 'https://ui-avatars.com/api/?name=J+S&background=4154f1&color=fff'
        },
        '3': {
          id: 3,
          username: 'mikejohnson',
          fullName: 'Mike Johnson',
          email: 'mike.johnson@example.com',
          role_id: 3,
          role: 'Author',
          description: 'Regular contributor focusing on food and travel content. Creates engaging articles and recipes.',
          created_at: '2023-03-10T00:00:00',
          updated_at: '2023-06-05T09:20:00',
          is_active: true,
          posts_count: 27,
          profile_image: 'https://ui-avatars.com/api/?name=M+J&background=4154f1&color=fff'
        }
      };
      
      userData = mockUsers[userId] || {
        id: parseInt(userId),
        username: 'user' + userId,
        fullName: 'User ' + userId,
        email: 'user' + userId + '@example.com',
        role_id: 5,
        role: 'Subscriber',
        description: 'User account',
        created_at: '2023-01-01T00:00:00',
        updated_at: '2023-01-01T00:00:00',
        is_active: true,
        posts_count: 0,
        profile_image: `https://ui-avatars.com/api/?name=U+${userId}&background=4154f1&color=fff`
      };
      
      updateUIWithUserData(userData);
      configureUIForOtherUser();
    }

    // Update UI elements with user data
    function updateUIWithUserData(user) {
      // Update page title
      document.title = `${user.fullName} Profile - Blog Admin`;
      
      // Profile card
      document.getElementById('profileImage').src = user.profile_image;
      document.getElementById('profileName').textContent = user.fullName;
      document.getElementById('profileRole').textContent = user.role;
      
      // Statistics
      document.getElementById('totalPosts').textContent = user.posts_count;
      document.getElementById('accountStatus').textContent = user.is_active ? 'Active' : 'Inactive';
      document.getElementById('accountStatus').className = user.is_active ? 'stat-card-value text-success' : 'stat-card-value text-danger';
      document.getElementById('joinedDate').textContent = formatDate(user.created_at);
      
      // Overview tab
      document.getElementById('userDescription').textContent = user.description;
      document.getElementById('fullName').textContent = user.fullName;
      document.getElementById('username').textContent = user.username;
      document.getElementById('email').textContent = user.email;
      document.getElementById('role').textContent = user.role;
      document.getElementById('status').textContent = user.is_active ? 'Active' : 'Inactive';
      document.getElementById('status').className = user.is_active ? 'text-success' : 'text-danger';
      document.getElementById('joined').textContent = formatDate(user.created_at);
      document.getElementById('lastUpdated').textContent = formatDate(user.updated_at);
      
      // Edit form
      document.getElementById('profileImageEditPreview').src = user.profile_image;
      document.getElementById('fullNameEdit').value = user.fullName;
      document.getElementById('usernameEdit').value = user.username;
      document.getElementById('emailEdit').value = user.email;
      document.getElementById('roleEdit').value = user.role_id;
      document.getElementById('statusEdit').checked = user.is_active;
      document.getElementById('descriptionEdit').value = user.description;
      
      // Load user posts
      loadUserPosts(user.id);
    }

    // Configure UI for viewing current user's profile (admin)
    function configureUIForCurrentUser() {
      // Show edit button and hide delete button
      document.getElementById('editProfileBtn').style.display = 'block';
      document.getElementById('deleteUserBtn').style.display = 'none';
      
      // Enable all tabs
      document.querySelectorAll('.nav-tabs .nav-link').forEach(tab => {
        tab.classList.remove('disabled-tab');
        tab.removeAttribute('disabled');
      });
    }

    // Configure UI for viewing another user's profile
    function configureUIForOtherUser() {
      // Hide edit button and show delete button
      document.getElementById('editProfileBtn').style.display = 'none';
      document.getElementById('deleteUserBtn').style.display = 'block';
      
      // Disable edit and change password tabs
      document.getElementById('edit-tab').classList.add('disabled-tab');
      document.getElementById('edit-tab').setAttribute('disabled', 'true');
      document.getElementById('change-password-tab').classList.add('disabled-tab');
      document.getElementById('change-password-tab').setAttribute('disabled', 'true');
      
      // Ensure overview tab is active
      document.getElementById('overview-tab').click();
    }

    // Load user posts
    function loadUserPosts(userId) {
      // In a real application, this would be an API call
      // For demo purposes, we're using mock data
      const mockPosts = {
        '1': [
          { id: 1, title: '10 Tips for Better SEO', category: 'Technology', language: 'English', date: '2023-11-01', status: 'Published' },
          { id: 5, title: 'Ultimate Guide to Remote Work', category: 'Lifestyle', language: 'English', date: '2023-10-23', status: 'Draft' },
          { id: 6, title: '10 conseils pour un meilleur référencement', category: 'Technology', language: 'French', date: '2023-10-20', status: 'Published' }
        ],
        '2': [
          { id: 2, title: 'Getting Started with Bootstrap', category: 'Technology', language: 'English', date: '2023-10-30', status: 'Published' }
        ],
        '3': [
          { id: 3, title: 'Healthy Breakfast Ideas', category: 'Food', language: 'English', date: '2023-10-28', status: 'Published' }
        ]
      };
      
      const posts = mockPosts[userId] || [];
      const tableBody = document.getElementById('userPostsList');
      const emptyMessage = document.getElementById('emptyPostsMessage');
      
      if (posts.length === 0) {
        tableBody.innerHTML = '';
        emptyMessage.style.display = 'block';
        return;
      }
      
      emptyMessage.style.display = 'none';
      tableBody.innerHTML = '';
      
      posts.forEach((post, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>${post.title}</td>
          <td>${post.category}</td>
          <td>${post.language}</td>
          <td>${post.date}</td>
          <td><span class="badge ${post.status === 'Published' ? 'bg-success' : 'bg-warning text-dark'}">${post.status}</span></td>
          <td>
            <div class="btn-group" role="group">
              <button type="button" class="btn btn-sm btn-primary" title="Edit Post">
                <i class="bi bi-pencil"></i>
              </button>
              <button type="button" class="btn btn-sm btn-info" title="View Post">
                <i class="bi bi-eye"></i>
              </button>
              <button type="button" class="btn btn-sm btn-danger" onclick="confirmDeletePost(event, ${post.id})" title="Delete Post">
                <i class="bi bi-trash"></i>
              </button>
            </div>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }

    // Setup event listeners
    function setupEventListeners() {
      // Edit profile button
      document.getElementById('editProfileBtn').addEventListener('click', () => {
        document.getElementById('edit-tab').click();
        document.getElementById('viewModeIndicator').style.display = 'none';
        document.getElementById('editModeIndicator').style.display = 'inline-block';
      });
      
      // Cancel edit button
      document.getElementById('cancelEditBtn').addEventListener('click', () => {
        document.getElementById('overview-tab').click();
        document.getElementById('viewModeIndicator').style.display = 'inline-block';
        document.getElementById('editModeIndicator').style.display = 'none';
      });
      
      // Delete user button
      document.getElementById('deleteUserBtn').addEventListener('click', () => {
        confirmDeleteUser(userData.id, userData.fullName);
      });
      
      // Tab change events
      document.querySelectorAll('.nav-tabs .nav-link').forEach(tab => {
        tab.addEventListener('shown.bs.tab', (e) => {
          if (e.target.id === 'edit-tab') {
            document.getElementById('viewModeIndicator').style.display = 'none';
            document.getElementById('editModeIndicator').style.display = 'inline-block';
          } else {
            document.getElementById('viewModeIndicator').style.display = 'inline-block';
            document.getElementById('editModeIndicator').style.display = 'none';
          }
        });
      });
      
      // Form submissions
      document.getElementById('profileEditForm').addEventListener('submit', function(e) {
        e.preventDefault();
        saveProfile();
      });
      
      document.getElementById('changePasswordForm').addEventListener('submit', function(e) {
        e.preventDefault();
        changePassword();
      });
    }

    // Format date for display
    function formatDate(dateString) {
      if (!dateString) return '-';
      
      const date = new Date(dateString);
      if (isNaN(date.getTime())) return dateString;
      
      return date.toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });
    }

    // Save profile changes
    function saveProfile() {
      // In a real application, this would be an API call
      // For demo purposes, we're just updating the UI
      
      // Update user data
      userData.fullName = document.getElementById('fullNameEdit').value;
      userData.username = document.getElementById('usernameEdit').value;
      userData.email = document.getElementById('emailEdit').value;
      userData.role_id = document.getElementById('roleEdit').value;
      userData.role = document.getElementById('roleEdit').options[document.getElementById('roleEdit').selectedIndex].text;
      userData.is_active = document.getElementById('statusEdit').checked;
      userData.description = document.getElementById('descriptionEdit').value;
      userData.updated_at = new Date().toISOString();
      
      // Update UI with new data
      updateUIWithUserData(userData);
      
      // Switch back to overview tab
      document.getElementById('overview-tab').click();
      
      // Show success message
      alert('Profile updated successfully!');
    }

    // Change password
    function changePassword() {
      // In a real application, this would be an API call
      // For demo purposes, we're just showing a success message
      
      const currentPassword = document.getElementById('currentPassword').value;
      const newPassword = document.getElementById('newPassword').value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      
      // Simple validation
      if (!currentPassword || !newPassword || !confirmPassword) {
        alert('Please fill in all password fields.');
        return;
      }
      
      if (newPassword !== confirmPassword) {
        alert('New password and confirmation do not match.');
        return;
      }
      
      // Reset form
      document.getElementById('changePasswordForm').reset();
      
      // Show success message
      alert('Password changed successfully!');
    }

    // Confirm delete user
    function confirmDeleteUser(userId, userName) {
      if (confirm(`Are you sure you want to delete the user "${userName}"? This action cannot be undone.`)) {
        // In a real application, this would be an API call
        // For demo purposes, we're just redirecting
        alert(`User "${userName}" has been deleted successfully.`);
        window.location.href = 'index.html'; // Redirect to users list
      }
    }

    // Confirm delete post
    function confirmDeletePost(event, postId) {
      if (confirm(`Are you sure you want to delete this post? This action cannot be undone.`)) {
        // In a real application, this would be an API call
        // For demo purposes, we're just removing the row
        event.target.closest('tr').remove();
        
        // Update posts count
        userData.posts_count--;
        document.getElementById('totalPosts').textContent = userData.posts_count;
        
        // Show empty message if no posts left
        if (userData.posts_count === 0) {
          document.getElementById('emptyPostsMessage').style.display = 'block';
        }
        
        // Show success message
        alert('Post deleted successfully!');
      }
    }

    // Preview image function
    function previewImage(input, previewId) {
      const preview = document.getElementById(previewId);
      if (!preview) return;
    
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = (e) => {
          preview.src = e.target.result;
          preview.style.display = 'block';
          
          // Also update profile image in real-time
          userData.profile_image = e.target.result;
          document.getElementById('profileImage').src = e.target.result;
        };
        reader.readAsDataURL(input.files[0]);
      }
    }
  </script>
</body>
</html>